generator client {
  provider = "prisma-client"
  output   = "../src/generated"
}

datasource db {
  provider = "postgresql"
}

model Announcement {
  id        Int       @id @default(autoincrement())
  title     String
  content   String
  createdAt DateTime? @default(now()) @db.Timestamp(6)
}

model Attendance {
  id        Int       @id @default(autoincrement())
  userId    String
  date      DateTime  @db.Date
  clockIn   DateTime  @db.Timestamp(6)
  clockOut  DateTime? @db.Timestamp(6)
  createdAt DateTime? @default(now()) @db.Timestamp(6)
  updatedAt DateTime? @default(now()) @db.Timestamp(6)
  User      User      @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([userId, date])
}

model Department {
  id        Int       @id @default(autoincrement())
  name      String    @unique
  createdAt DateTime? @default(now()) @db.Timestamp(6)
  updatedAt DateTime? @default(now()) @db.Timestamp(6)
  User      User[]
}

model Leave {
  id        Int          @id @default(autoincrement())
  userId    String
  startDate DateTime     @db.Timestamp(6)
  endDate   DateTime     @db.Timestamp(6)
  reason    String
  status    LeaveStatus? @default(PENDING)
  createdAt DateTime?    @default(now()) @db.Timestamp(6)
  updatedAt DateTime?    @default(now()) @db.Timestamp(6)
  User      User         @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model User {
  id           String       @id @default(uuid())
  clerkUserId  String       @unique
  email        String       @unique
  firstName    String?
  lastName     String?
  status       UserStatus  @default(PENDING)
  role         Role?        @default(WORKER)
  departmentId Int?
  createdAt    DateTime?    @default(now()) @db.Timestamp(6)
  updatedAt    DateTime?    @default(now()) @db.Timestamp(6)
  Attendance   Attendance[]
  Leave        Leave[]
  Department   Department?  @relation(fields: [departmentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

enum LeaveStatus {
  PENDING
  APPROVED
  DENIED
}

enum Role {
  ADMIN
  WORKER
}

enum UserStatus {
  ACTIVE
  INACTIVE
  PENDING
}
